# xpdf

## version 

    xpdf 4.01.01

## description

```txt
Xpdf is a free PDF viewer and toolkit, including a text extractor, image converter, HTML converter, and more.
```

## download link

    https://xpdfreader-dl.s3.amazonaws.com/xpdf-4.00.tar.gz

## others

    please send email to  teamSeri0us360@gmail.com if you have any questions.

---------------------

## GfxPatchMeshShading::parse@GfxState.cc:3194-13___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01, There is a/an SEGV_UNKNOW in function GfxPatchMeshShading::parse at GfxState.cc:3194-13

### commandline

    pdftotext @@ out.txt

### source

```c
3190 	  p->color[1][0][j] = c[1][j];
3191 	}
3192 	break;
3193       case 3:
>3194 	p->x[0][0] =  \*bug=>*\ patchesA[nPatchesA-1].x[3][0];
3195 	p->y[0][0] = patchesA[nPatchesA-1].y[3][0];
3196 	p->x[0][1] = patchesA[nPatchesA-1].x[2][0];
3197 	p->y[0][1] = patchesA[nPatchesA-1].y[2][0];
3198 	p->x[0][2] = patchesA[nPatchesA-1].x[1][0];
3199 	p->y[0][2] = patchesA[nPatchesA-1].y[1][0];

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==10948==ERROR: AddressSanitizer: SEGV on unknown address 0x629ffffffd60 (pc 0x00000067ad2d bp 0x7ffcbbcf68f0 sp 0x7ffcbbcf5c20 T0)
    #0 0x67ad2c in GfxPatchMeshShading::parse(int, Dict*, Stream*) /src/xpdf/xpdf/GfxState.cc:3194:13
    #1 0x66aad4 in GfxShading::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1934:17
    #2 0x668ce9 in GfxShadingPattern::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1804:14
    #3 0x66685b in GfxPattern::parse(Object*, Object*) /src/xpdf/xpdf/GfxState.cc:1661:15
    #4 0x607906 in GfxResources::lookupPattern(char const*) /src/xpdf/xpdf/Gfx.cc:428:12
    #5 0x603606 in Gfx::opSetFillColorN(Object*, int) /src/xpdf/xpdf/Gfx.cc:1561:20
    #6 0x60dd3f in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #7 0x60c37f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #8 0x60ad96 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #9 0x76c3d6 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #10 0x76bca5 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #11 0x77d84b in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #12 0x77d84b in PDFDoc::displayPages(OutputDev*, int, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:436
    #13 0x56357a in main /src/xpdf/xpdf/pdftotext.cc:253:5
    #14 0x7fb9c38d582f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291
    #15 0x449378 in _start (/src/aflbuild/installed/bin/pdftotext+0x449378)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/GfxState.cc:3194:13 in GfxPatchMeshShading::parse(int, Dict*, Stream*)
==10948==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftotext-06
    crash name pwd-xpdf-pdftotext-06-00000660-20190609.pdf
    Auto-generated by pyspider at 2019-06-09 16:01:17