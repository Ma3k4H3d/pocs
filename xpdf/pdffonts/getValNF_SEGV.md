# xpdf

## version 

    xpdf 4.01

## description

```txt
```

## download link


---------------------


## Dict::getValNF@Dict.cc:144-10___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01, There is an out-of-bounds-read in function Dict::getValNF at Dict.cc:144-10

### commandline

    pdffonts @@

### source

```c
 140   return entries[i].val.fetch(xref, obj);
 141 }
 142 
 143 Object *Dict::getValNF(int i, Object *obj) {
> 144   return entries[i].val.copy(obj);
 145 }

```

debu
g
```txt
pwndbg> p entries 
Cannot access memory at address 0xd
```

### bug report

```txt
Config Error: No display font for 'Courier'
Config Error: No display font for 'Courier-Bold'
Config Error: No display font for 'Courier-BoldOblique'
Config Error: No display font for 'Courier-Oblique'
Config Error: No display font for 'Helvetica'
Config Error: No display font for 'Helvetica-Bold'
Config Error: No display font for 'Helvetica-BoldOblique'
Config Error: No display font for 'Helvetica-Oblique'
Config Error: No display font for 'Symbol'
Config Error: No display font for 'Times-Bold'
Config Error: No display font for 'Times-BoldItalic'
Config Error: No display font for 'Times-Italic'
Config Error: No display font for 'Times-Roman'
Config Error: No display font for 'ZapfDingbats'
Syntax Error: Couldn't read xref table
Syntax Warning: PDF file is damaged - attempting to reconstruct xref table...
Syntax Error (240): Dictionary key must be a name object
Syntax Error (244): Dictionary key must be a name object
ASAN:DEADLYSIGNAL
=================================================================
==3585==ERROR: AddressSanitizer: SEGV on unknown address 0x00000000000d (pc 0x00000058c3fc bp 0x7ffd7bf6c0b0 sp 0x7ffd7bf6bb30 T0)
    #0 0x58c3fb in Dict::getValNF(int, Object*) /src/xpdf/xpdf/Dict.cc:144:10
    #1 0x51f10f in Object::dictGetValNF(int, Object*) /src/xpdf/xpdf/Object.h:279:12
    #2 0x51f10f in scanFonts(Dict*, PDFDoc*) /src/xpdf/xpdf/pdffonts.cc:305
    #3 0x51b41f in main /src/xpdf/xpdf/pdffonts.cc:176:7
    #4 0x7fd8b4c9982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #5 0x446598 in _start (/src/aflbuild/installed/bin/pdffonts+0x446598)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/Dict.cc:144:10 in Dict::getValNF(int, Object*)
==3585==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdffonts-05
    crash name pwd-xpdf-pdffonts-05-00000119-20190411.pdf
    Auto-generated by pyspider at 2019-04-11 11:11:50

