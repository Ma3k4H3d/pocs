# xpdf

## version

    xpdf 4.01.01

## description

```txt
Xpdf is a free PDF viewer and toolkit, including a text extractor, image converter, HTML converter, and more.
```

## download link

    https://xpdfreader-dl.s3.amazonaws.com/xpdf-4.00.tar.gz

---------------------

## JBIG2Bitmap::combine@JBIG2Stream.cc:877-24___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01.01, There is a/an SEGV_UNKNOW in function JBIG2Bitmap::combine at JBIG2Stream.cc:877-24

### commandline

    pdftohtml @@ out.html

### source

```c
 873     // one byte per line -- need to mask both left and right side
 874     if (oneByte) {
 875       if (x >= 0) {
 876 	destPtr = data + (y + yy) * line + (x >> 3);
> 877 	srcPtr = bitmap->data + yy * bitmap->line;
 878 	dest = *destPtr;
 879 	src1 = *srcPtr;
 880 	switch (combOp) {
 881 	case 0: // or
 882 	  dest |= (Guchar)((src1 >> s1) & m2);

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==26167==ERROR: AddressSanitizer: SEGV on unknown address 0x611080008ebe (pc 0x00000071261e bp 0x603000001528 sp 0x7fff0d806130 T0)
    #0 0x71261d in JBIG2Bitmap::combine(JBIG2Bitmap*, int, int, unsigned int) /src/xpdf/xpdf/JBIG2Stream.cc:877:24
    #1 0x72df71 in JBIG2Stream::readGenericRegionSeg(unsigned int, int, int, unsigned int) /src/xpdf/xpdf/JBIG2Stream.cc:2738:5
    #2 0x7183ff in JBIG2Stream::readSegments() /src/xpdf/xpdf/JBIG2Stream.cc:1412:7
    #3 0x716a39 in JBIG2Stream::reset() /src/xpdf/xpdf/JBIG2Stream.cc:1225:3
    #4 0x826105 in Object::streamReset() /src/xpdf/xpdf/Object.h:294:5
    #5 0x826105 in XFAForm::load(PDFDoc*, Catalog*, Object*, Object*) /src/xpdf/xpdf/XFAForm.cc:408
    #6 0x616c62 in Form::load(PDFDoc*, Catalog*, Object*) /src/xpdf/xpdf/Form.cc:38:14
    #7 0x5dd268 in Catalog::Catalog(PDFDoc*) /src/xpdf/xpdf/Catalog.cc:180:10
    #8 0x7c33c4 in PDFDoc::setup2(GString*, GString*, int) /src/xpdf/xpdf/PDFDoc.cc:299:17
    #9 0x7c2440 in PDFDoc::setup(GString*, GString*) /src/xpdf/xpdf/PDFDoc.cc:257:12
    #10 0x7c28f9 in PDFDoc::PDFDoc(char*, GString*, GString*, PDFCore*) /src/xpdf/xpdf/PDFDoc.cc:199:8
    #11 0x5a9b67 in main /src/xpdf/xpdf/pdftohtml.cc:129:13
    #12 0x7f28e50e482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #13 0x451238 in _start (/src/aflbuild/installed/bin/pdftohtml+0x451238)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/JBIG2Stream.cc:877:24 in JBIG2Bitmap::combine(JBIG2Bitmap*, int, int, unsigned int)
==26167==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftohtml-03
    crash name pwd-xpdf-pdftohtml-03-00000770-20190615.pdf
    Auto-generated by pyspider at 2019-06-15 22:37:26
