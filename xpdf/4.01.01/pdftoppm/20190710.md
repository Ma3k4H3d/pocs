# xpdf

## version 

    xpdf 4.01.01

## description

```txt
Xpdf is a free PDF viewer and toolkit, including a text extractor, image converter, HTML converter, and more.
```

## download link

    https://xpdfreader-dl.s3.amazonaws.com/xpdf-4.00.tar.gz

---------------------

## GfxPatchMeshShading::parse@GfxState.cc:3309-13___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01.01, There is a/an SEGV_UNKNOW in function GfxPatchMeshShading::parse at GfxState.cc:3309-13

### commandline

    pdftoppm @@ out.ppm

### source

```c
3305 	  p->color[1][0][j] = c[1][j];
3306 	}
3307 	break;
3308       case 2:
>3309 	p->x[0][0] =  \*bug=>*\ patchesA[nPatchesA-1].x[3][3];
3310 	p->y[0][0] = patchesA[nPatchesA-1].y[3][3];
3311 	p->x[0][1] = patchesA[nPatchesA-1].x[3][2];
3312 	p->y[0][1] = patchesA[nPatchesA-1].y[3][2];
3313 	p->x[0][2] = patchesA[nPatchesA-1].x[3][1];
3314 	p->y[0][2] = patchesA[nPatchesA-1].y[3][1];

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==5808==ERROR: AddressSanitizer: SEGV on unknown address 0x629ffffffd78 (pc 0x0000006739df bp 0x7ffc108a1350 sp 0x7ffc108a0680 T0)
    #0 0x6739de in GfxPatchMeshShading::parse(int, Dict*, Stream*) /src/xpdf/xpdf/GfxState.cc:3309:13
    #1 0x664474 in GfxShading::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1934:17
    #2 0x662689 in GfxShadingPattern::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1804:14
    #3 0x6601fb in GfxPattern::parse(Object*, Object*) /src/xpdf/xpdf/GfxState.cc:1661:15
    #4 0x6012a6 in GfxResources::lookupPattern(char const*) /src/xpdf/xpdf/Gfx.cc:428:12
    #5 0x5fcfa6 in Gfx::opSetFillColorN(Object*, int) /src/xpdf/xpdf/Gfx.cc:1561:20
    #6 0x6076df in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #7 0x605d1f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #8 0x604736 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #9 0x766256 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #10 0x765b25 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #11 0x777537 in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #12 0x55cf3f in main /src/xpdf/xpdf/pdftoppm.cc:229:5
    #13 0x7f69e4d0982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #14 0x44de68 in _start (/src/aflbuild/installed/bin/pdftoppm+0x44de68)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/GfxState.cc:3309:13 in GfxPatchMeshShading::parse(int, Dict*, Stream*)
==5808==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftoppm-00
    crash name pwd-xpdf-pdftoppm-00-00000435-20190523.pdf
    Auto-generated by pyspider at 2019-05-23 00:32:55

## JPXStream::fillReadBuf@JPXStream.cc:430-16___heap-use-after-free

### description

    An issue was discovered in xpdf 4.01.01, There is a/an heap-use-after-free in function JPXStream::fillReadBuf at JPXStream.cc:430-16

### commandline

    pdftoppm @@ out.ppm

### source

```c
 426     tx = jpxFloorDiv((curX - img.xTileOffsetR) % img.xTileSizeR,
 427 		     tileComp->hSep);
 428     ty = jpxFloorDiv((curY - img.yTileOffsetR) % img.yTileSizeR,
 429 		     tileComp->vSep);
> 430     pix = (int)tileComp->data[ty * tileComp->w + tx];
 431     pixBits = tileComp->prec;
 432     eol = gFalse;
 433 #if 1 //~ ignore the palette, assume the PDF ColorSpace object is valid
 434     if (++curComp == img.nComps) {
 435 #else

```

### bug report

```txt
=================================================================
==7170==ERROR: AddressSanitizer: heap-use-after-free on address 0x7fe5adb8db0c at pc 0x0000007056ea bp 0x7ffdc9577870 sp 0x7ffdc9577868
READ of size 4 at 0x7fe5adb8db0c thread T0
    #0 0x7056e9 in JPXStream::fillReadBuf() /src/xpdf/xpdf/JPXStream.cc:430:16
    #1 0x7049c7 in JPXStream::getChar() /src/xpdf/xpdf/JPXStream.cc:372:5
    #2 0x77ffea in Stream::getBlock(char*, int) /src/xpdf/xpdf/Stream.cc:77:14
    #3 0x784338 in ImageStream::getLine() /src/xpdf/xpdf/Stream.cc:415:7
    #4 0x54c2d1 in SplashOutputDev::imageSrc(void*, unsigned char*, unsigned char*) /src/xpdf/xpdf/SplashOutputDev.cc:3318:13
    #5 0x9026b0 in Splash::scaleImageYuXu(int (*)(void*, unsigned char*, unsigned char*), void*, SplashColorMode, int, int, int, int, int, int, SplashBitmap*) /src/xpdf/splash/Splash.cc:5586:5
    #6 0x8ec9a6 in Splash::scaleImage(int (*)(void*, unsigned char*, unsigned char*), void*, SplashColorMode, int, int, int, int, int, int, int) /src/xpdf/splash/Splash.cc:5077:2
    #7 0x8e740a in Splash::drawImage(int (*)(void*, unsigned char*, unsigned char*), void*, SplashColorMode, int, int, int, double*, int) /src/xpdf/splash/Splash.cc:4492:19
    #8 0x54e575 in SplashOutputDev::drawImage(GfxState*, Object*, Stream*, int, int, GfxImageColorMap*, int*, int, int) /src/xpdf/xpdf/SplashOutputDev.cc:3562:3
    #9 0x626a5d in Gfx::doImage(Object*, Stream*, int) /src/xpdf/xpdf/Gfx.cc:4563:2
    #10 0x5e3e4f in Gfx::opXObject(Object*, int) /src/xpdf/xpdf/Gfx.cc:4082:2
    #11 0x6076df in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #12 0x605d1f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #13 0x604736 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #14 0x766256 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #15 0x765b25 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #16 0x777537 in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #17 0x55cf3f in main /src/xpdf/xpdf/pdftoppm.cc:229:5
    #18 0x7fe5b070582f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #19 0x44de68 in _start (/src/aflbuild/installed/bin/pdftoppm+0x44de68)

0x7fe5adb8db0c is located 2614028 bytes inside of 3079816-byte region [0x7fe5ad90f800,0x7fe5adbff688)
freed by thread T0 here:
    #0 0x4ede10 in __interceptor_cfree.localalias.0 (/src/aflbuild/installed/bin/pdftoppm+0x4ede10)
    #1 0x82f5c7 in gfree /src/xpdf/goo/gmem.cc:347:5

previously allocated by thread T0 here:
    #0 0x4edf98 in __interceptor_malloc (/src/aflbuild/installed/bin/pdftoppm+0x4edf98)
    #1 0x82e66d in gmalloc /src/xpdf/goo/gmem.cc:146:13

SUMMARY: AddressSanitizer: heap-use-after-free /src/xpdf/xpdf/JPXStream.cc:430:16 in JPXStream::fillReadBuf()
Shadow bytes around the buggy address:
  0x0ffd35b69b10: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b20: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b30: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b40: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b50: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0ffd35b69b60: fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b80: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69b90: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69ba0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0ffd35b69bb0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7170==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftoppm-00
    crash name pwd-xpdf-pdftoppm-00-00000451-20190527.pdf
    Auto-generated by pyspider at 2019-05-27 10:03:56

## GfxPatchMeshShading::parse@GfxState.cc:3162-13___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01.01, There is a/an SEGV_UNKNOW in function GfxPatchMeshShading::parse at GfxState.cc:3162-13

### commandline

    pdftoppm @@ out.ppm

### source

```c
3158 	  p->color[1][0][j] = c[1][j];
3159 	}
3160 	break;
3161       case 2:
>3162 	p->x[0][0] = patchesA[nPatchesA-1].x[3][3];
3163 	p->y[0][0] = patchesA[nPatchesA-1].y[3][3];
3164 	p->x[0][1] = patchesA[nPatchesA-1].x[3][2];
3165 	p->y[0][1] = patchesA[nPatchesA-1].y[3][2];
3166 	p->x[0][2] = patchesA[nPatchesA-1].x[3][1];
3167 	p->y[0][2] = patchesA[nPatchesA-1].y[3][1];

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==12313==ERROR: AddressSanitizer: SEGV on unknown address 0x629ffffffd78 (pc 0x000000672f25 bp 0x7ffc9ecdf230 sp 0x7ffc9ecde560 T0)
    #0 0x672f24 in GfxPatchMeshShading::parse(int, Dict*, Stream*) /src/xpdf/xpdf/GfxState.cc:3162:13
    #1 0x664474 in GfxShading::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1934:17
    #2 0x662689 in GfxShadingPattern::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1804:14
    #3 0x6601fb in GfxPattern::parse(Object*, Object*) /src/xpdf/xpdf/GfxState.cc:1661:15
    #4 0x6012a6 in GfxResources::lookupPattern(char const*) /src/xpdf/xpdf/Gfx.cc:428:12
    #5 0x5fcfa6 in Gfx::opSetFillColorN(Object*, int) /src/xpdf/xpdf/Gfx.cc:1561:20
    #6 0x6076df in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #7 0x605d1f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #8 0x604736 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #9 0x766256 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #10 0x765b25 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #11 0x777537 in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #12 0x55cf3f in main /src/xpdf/xpdf/pdftoppm.cc:229:5
    #13 0x7f65b6e8482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #14 0x44de68 in _start (/src/aflbuild/installed/bin/pdftoppm+0x44de68)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/GfxState.cc:3162:13 in GfxPatchMeshShading::parse(int, Dict*, Stream*)
==12313==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftoppm-00
    crash name pwd-xpdf-pdftoppm-00-00000457-20190530.pdf
    Auto-generated by pyspider at 2019-05-30 11:34:39

## GfxPatchMeshShading::parse@GfxState.cc:3269-13___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01, There is a/an SEGV_UNKNOW in function GfxPatchMeshShading::parse at GfxState.cc:3269-13

### commandline

    pdftoppm @@ out.ppm

### source

```c
3265 	  p->color[1][0][j] = c[3][j];
3266 	}
3267 	break;
3268       case 1:
>3269 	p->x[0][0] =  \*bug=>*\ patchesA[nPatchesA-1].x[0][3];
3270 	p->y[0][0] = patchesA[nPatchesA-1].y[0][3];
3271 	p->x[0][1] = patchesA[nPatchesA-1].x[1][3];
3272 	p->y[0][1] = patchesA[nPatchesA-1].y[1][3];
3273 	p->x[0][2] = patchesA[nPatchesA-1].x[2][3];
3274 	p->y[0][2] = patchesA[nPatchesA-1].y[2][3];

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==31856==ERROR: AddressSanitizer: SEGV on unknown address 0x629ffffffd18 (pc 0x00000067692d bp 0x7ffe010140b0 sp 0x7ffe010133e0 T0)
    #0 0x67692c in GfxPatchMeshShading::parse(int, Dict*, Stream*) /src/xpdf/xpdf/GfxState.cc:3269:13
    #1 0x664474 in GfxShading::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1934:17
    #2 0x662689 in GfxShadingPattern::parse(Object*) /src/xpdf/xpdf/GfxState.cc:1804:14
    #3 0x6601fb in GfxPattern::parse(Object*, Object*) /src/xpdf/xpdf/GfxState.cc:1661:15
    #4 0x6012a6 in GfxResources::lookupPattern(char const*) /src/xpdf/xpdf/Gfx.cc:428:12
    #5 0x5fcfa6 in Gfx::opSetFillColorN(Object*, int) /src/xpdf/xpdf/Gfx.cc:1561:20
    #6 0x6076df in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #7 0x605d1f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #8 0x604736 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #9 0x766256 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #10 0x765b25 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #11 0x777537 in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #12 0x55cf3f in main /src/xpdf/xpdf/pdftoppm.cc:229:5
    #13 0x7fca405bc82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #14 0x44de68 in _start (/src/aflbuild/installed/bin/pdftoppm+0x44de68)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/GfxState.cc:3269:13 in GfxPatchMeshShading::parse(int, Dict*, Stream*)
==31856==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftoppm-00
    crash name pwd-xpdf-pdftoppm-00-00000496-20190611.pdf
    Auto-generated by pyspider at 2019-06-11 22:37:30

## JBIG2Bitmap::combine@JBIG2Stream.cc:932-9___SEGV_UNKNOW

### description

    An issue was discovered in xpdf 4.01.01, There is a/an SEGV_UNKNOW in function JBIG2Bitmap::combine at JBIG2Stream.cc:932-9

### commandline

    pdftoppm @@ out.ppm

### source

```c
 928       if (x >= 0) {
 929 	destPtr = data + (y + yy) * line + (x >> 3);
 930 	srcPtr = bitmap->data + yy * bitmap->line;
 931 	src1 = *srcPtr++;
> 932 	dest = *destPtr;
 933 	switch (combOp) {
 934 	case 0: // or
 935 	  dest |= (Guchar)(src1 >> s1);
 936 	  break;
 937 	case 1: // and

```

### bug report

```txt
ASAN:DEADLYSIGNAL
=================================================================
==5353==ERROR: AddressSanitizer: SEGV on unknown address 0x62b28001409c (pc 0x0000006c5125 bp 0x6030000014c8 sp 0x7ffdc1fec790 T0)
    #0 0x6c5124 in JBIG2Bitmap::combine(JBIG2Bitmap*, int, int, unsigned int) /src/xpdf/xpdf/JBIG2Stream.cc:932:9
    #1 0x6f19e9 in JBIG2Stream::readTextRegion(int, int, int, int, unsigned int, unsigned int, int, JBIG2HuffmanTable*, unsigned int, JBIG2Bitmap**, unsigned int, unsigned int, unsigned int, unsigned int, int, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, JBIG2HuffmanTable*, unsigned int, int*, int*) /src/xpdf/xpdf/JBIG2Stream.cc:2392:6
    #2 0x6d8d8c in JBIG2Stream::readTextRegionSeg(unsigned int, int, int, unsigned int, unsigned int*, unsigned int) /src/xpdf/xpdf/JBIG2Stream.cc:2196:12
    #3 0x6cabb5 in JBIG2Stream::readSegments() /src/xpdf/xpdf/JBIG2Stream.cc:1388:7
    #4 0x6c9419 in JBIG2Stream::reset() /src/xpdf/xpdf/JBIG2Stream.cc:1225:3
    #5 0x54dcc7 in SplashOutputDev::drawImage(GfxState*, Object*, Stream*, int, int, GfxImageColorMap*, int*, int, int) /src/xpdf/xpdf/SplashOutputDev.cc:3498:3
    #6 0x626a5d in Gfx::doImage(Object*, Stream*, int) /src/xpdf/xpdf/Gfx.cc:4563:2
    #7 0x5e3e4f in Gfx::opXObject(Object*, int) /src/xpdf/xpdf/Gfx.cc:4082:2
    #8 0x6076df in Gfx::execOp(Object*, Object*, int) /src/xpdf/xpdf/Gfx.cc:826:3
    #9 0x605d1f in Gfx::go(int) /src/xpdf/xpdf/Gfx.cc:719:12
    #10 0x604736 in Gfx::display(Object*, int) /src/xpdf/xpdf/Gfx.cc:641:3
    #11 0x766256 in Page::displaySlice(OutputDev*, double, double, int, int, int, int, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:373:5
    #12 0x765b25 in Page::display(OutputDev*, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/Page.cc:321:3
    #13 0x777537 in PDFDoc::displayPage(OutputDev*, int, double, double, int, int, int, int, int (*)(void*), void*) /src/xpdf/xpdf/PDFDoc.cc:423:3
    #14 0x55cf3f in main /src/xpdf/xpdf/pdftoppm.cc:229:5
    #15 0x7f408bee282f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #16 0x44de68 in _start (/src/aflbuild/installed/bin/pdftoppm+0x44de68)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /src/xpdf/xpdf/JBIG2Stream.cc:932:9 in JBIG2Bitmap::combine(JBIG2Bitmap*, int, int, unsigned int)
==5353==ABORTING

```

### others

    from fuzz project pwd-xpdf-pdftoppm-00
    crash name pwd-xpdf-pdftoppm-00-00000589-20190707.pdf
    Auto-generated by pyspider at 2019-07-07 17:43:29
