# bento4

## version 

    bento4 1.5.1.0

## description

```txt
None
```

## download link

    None

## others

    please send email to  teamseri0us360@gmail.com if you have any questions.

---------------------

## ShowAvcInfo@Mp4Info.cpp-948___heap-buffer-overflow

### description

    An issue was discovered in bento4 1.5.1.0, There is a/an heap-buffer-overflow in function ShowAvcInfo at Mp4Info.cpp-948

### commandline

    mp4info --show-samples @@

### source

```c
 944         } else {
 945             size = 0;
 946         }
 947         
 948         switch (*data & 0x1F) {
 949             case 1: {
 950                 AP4_BitStream bits;
 951                 bits.WriteBytes(data+1, 8);
 952                 ReadGolomb(bits);
 953                 unsigned int slice_type = ReadGolomb(bits);

```

### bug report

```txt
=================================================================
==18547==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f281a2fe8ec at pc 0x00000044f75d bp 0x7fff8dfaa490 sp 0x7fff8dfaa480
READ of size 1 at 0x7f281a2fe8ec thread T0
    #0 0x44f75c in ShowAvcInfo /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:948
    #1 0x44f75c in ShowSample_Text /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:1014
    #2 0x457e5e in ShowTrackInfo_Text /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:1169
    #3 0x458b22 in ShowTrackInfo /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:1276
    #4 0x458b22 in ShowTracks /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:1386
    #5 0x4404e7 in main /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:1650
    #6 0x7f281d16b82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x446878 in _start (/src/aflbuild/installed/bin/mp4info+0x446878)

0x7f281a2fe8ec is located 0 bytes to the right of 16384236-byte region [0x7f281935e800,0x7f281a2fe8ec)
allocated by thread T0 here:
    #0 0x7f281db466b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x61a7ff in AP4_DataBuffer::ReallocateBuffer(unsigned int) /src/bento4/Source/C++/Core/Ap4DataBuffer.cpp:210
    #2 0x61a7ff in AP4_DataBuffer::SetDataSize(unsigned int) /src/bento4/Source/C++/Core/Ap4DataBuffer.cpp:151

SUMMARY: AddressSanitizer: heap-buffer-overflow /src/bento4/Source/C++/Apps/Mp4Info/Mp4Info.cpp:948 ShowAvcInfo
Shadow bytes around the buggy address:
  0x0fe583457cc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe583457cd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe583457ce0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe583457cf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0fe583457d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0fe583457d10: 00 00 00 00 00 00 00 00 00 00 00 00 00[04]fa fa
  0x0fe583457d20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0fe583457d30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0fe583457d40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0fe583457d50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0fe583457d60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==18547==ABORTING

```

### others

    from fuzz project pwd-bento4-mp4info-01
    crash name pwd-bento4-mp4info-01-00000001-20190809.mp4
    Auto-generated by pyspider at 2019-08-09 11:04:22
    
    please send email to  teamseri0us360@gmail.com if you have any questions.

### 
